# DAKI-KG

## Table of contents
1. [Introduction](#introduction)
2. [Sources](#sources)
3. [Contents](#contents)
4. [Usage](#usage)
6. [Future Work](#future-work)
7. [Licensing](#licensing)

## Introduction
We present a Knowledge Graph (KG) for Drug-Induced Acute Kidney Injury (DAKI). The DAKI-KG contains domain knowledge about drugs known to cause acute kidney injury (AKI), such as their indications, contra-indications, adverse events and drug-drug interactions. The aim of the DAKI-KG is to be applied to a varying number of tasks, such as variable (drug) analysis, confounder analysis and research surrounding QA systems. 

We developed our KG through a semi-automated process with a strong focus on trustworthy domain knowledge sources and expert knowledge. Through the automated processes, it is possible that some facts are not fully complete or accurate, hence we do not recommend the DAKI-KG to be used in the clinical practice. In our paper ([link]()), we describe the full integration and evaluation process. 

## Contents
![DAKI-KG ontology](/images/daki-kg-ontology.png)

### Classes
Because the DAKI-KG is standardized through SNOMED CT and ATC, it inherits their hierarchical structure. In these systems, concepts are organized in taxonomies (i.e., each concept is a type or class that may have more specific subtypes). As a result, the entities represented in the graph are not individual instances of diseases or drugs, but rather classes (or categories) of them. We typed these classes with regards to the broad category they belong to:

| Class | Description |
|-----------|-------------|
| `:Drug` | Represents a low-level ATC code (3 or lower). |
| `:DrugClass` | Represents a 2nd-level ATC code. |
| `:NephrotoxicConcept` | Represents the combination of the AKIConcepts and CKDConcepts. |
| `:AKIConcept` | Groups terms relevant to AKI. |
| `:CKDConcept` | Groups terms relevant to CKD. |
| `:DDI` | Represents a drug-drug interaction group. |

The concepts that are not drugs/drug-drug interactions are all mapped to SNOMED CT concepts, and fall under the `sct:138875005`, the SNOMED CT root class. 

### Properties
| Property  | Description | 
|------------|-------------|
| `:hasAdverseEvent` | Describes an adverse event of a drug. |
| `:hasFrequency`** | Describes for a drug-adverse event triple the reported frequency. The possible frequency categories are: 5 (very often), 4 (often), 3 (moderate), 2 (rare), 1 (very rare), and -1 (unspecified).|
| `:isIndicatedFor` | Describes a therapeutic use (indication) of a drug. |
| `:isContraIndicatedFor` | Describes a contraindication of a drug. |
| `:isRiskFactorFor` | Describes a risk factor for a disease. Both drugs and clinical findings can be a risk factor. |
| `:hasInteractionWith` | Describes an interaction between two drugs. This is a symmetric property*. |
| `:isMemberOfInteraction`** | Describes the link from an interaction triple to an interaction type. RDF-star property. |
| `:hasNephrotoxicEffect` | Describes whether the effect of a drug-drug interaction is potentially nephrotoxic. The possible categories are: 0 (no nephrotoxic effect), 1 (DDI is considered higher risk in patients with diminished kidney function), and 2 (potentially nephrotoxic effect).
| `:requiresAction` | Describes whether a drug-drug interaction requires any action. Boolean value. |

\* Note that in the case of an RDF-star annotation over a symmetric triple, the symmetry is not automatically inferred with most reasoners. Ensure to SPARQL query both sides in such cases: see e.g. competency question 1.6 (```sparql/competency_questions/clinical_use_case/cq1_6.rq```).

\*\* These are RDF-star properties, i.e. a statement over a triple << (s, p, o) >> p2 o2 .

### Prefixes 
```turtle
PREFIX sct: <http://snomed.info/id/> 
PREFIX dakikg: <http://w3id.org/dakikg#> 
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> 
PREFIX atc:  <http://purl.bioontology.org/ontology/ATC/> 
PREFIX skos: <http://www.w3.org/2004/02/skos/core#> 
PREFIX dcterms: <http://purl.org/dc/terms/> 
```

## Usage

### Data Integration
The DAKI-KG is built from 8 separate files. The files can be loaded directly into GraphDB with no other integration steps  neccessary. The exception is the SNOMED CT hierarchy file (*snomed_hierarchy.ttls*), which can be generated by: 
1. download SNOMED through the [SNOMED CT](https://www.snomed.org/) website. We used the Dutch SNOMED CT version from 31-10-2024.
3. Load into some sql database (e.g., follow the steps as described [here](https://github.com/Majeed7/EntityLinking/), specifically the *dbcreation* dir).
4. The hierarchy can be extracted directly in RDF-format by running the *create_snomed_hierarchy.py* script, resulting in the *snomed_hierarchy.ttls file*. 

The main graph contains the following files:
- **intrinsic_drug_properties.ttls**: this contains all data extracted from FK and automatically mapped to SNOMED CT terms with an entity linking tool. That is, indications, contra-indications, and adverse events for all drugs in scope of the DAKI-KG. It also contains indications that are extracted through the FK indication pages. Please read the full paper for details on this process. 
- **drug_groups.ttls**: this contains the 2nd level ATC group for each drug in scope, as well as its human-readable label in English.
- **drug_interactions.ttls**: this contains all drug-drug interactions (all types), their nephrotoxicity labels, and whether they require an action.
- **aki_risk_factors.ttls**: this contains all risk factors (both drugs and clinical findings) for AKI.
- **nephrotoxic_concepts.ttls**: this contains the SNOMED CT concepts that fall under the NephrotoxicConcept class (AKIConcept and CKDConcept).
- **ontology.ttl**: contains the DAKI-KG ontology.

The metadata folder contains the following files:
- **drug_inclusion_rationale.ttls**: for the main drugs in scope, this gives the reason why they are in scope (e.g., indication for diabetes). This also contains some extra indications and risk factors, as further described in the full paper. Any drug that is not mentioned in this file, but is in the DAKI-KG, is included because it interacts with any of the drugs mentioned within the file.
- **elt_metadata.ttls**: this contains the triples followed from the ELT, and their metadata: that is, the extraction date, similarily score following from the ELT, and the isolated fragment on which the ELT matched a SNOMED CT entity.

SNOMED files (not downloadable from this repo, requires your own SNOMED CT license (please read steps described above)):
- **snomed_hierarchy.ttls** this is the full SNOMED CT hierarchy. Only concepts and rdfs:subClassOf relations, no labels.
- **snomed_preferred_terms.ttls**: this contains both English and Dutch labels (only the preferred labels) for the SNOMED CT concepts.

### Competency Questions
The queries for the competency questions can be found in the *queries/cq/* folder. The filenames refer to the CQ number:

#### 1. Queries related to the clinical context application area and which could be asked by healthcare professionals prescribing medication to CKD patients
1. Which drugs for the treatment of diabetes have AKI as a side-effect?
2. item Which drugs for the treatment of diabetes do not have AKI as a side- effect?
3. Which drugs for the treatment of heart failure have AKI as a side-effect?
4. Which drugs interact with tacrolimus compromising kidney safety (nephro-DDIs)?
5. Which drugs interact with aciclovir compromising kidney safety (nephro-DDIs)?
6. Which antibiotic(s) to treat sepsis has/have the lowest frequency of AKI as a side-effect?
7. Which drugs for the treatment of diabetes are contra-indicated in patients with CKD?
8. Which drug-drug interactions may occur when prescribing naproxen, furosemide and enalapril concomitantly?
9. Which side-effects may occur when prescribing naproxen, furosemide and enalapril concomitantly?
10. Which side-effects are very frequent (10\%) for lithium?
11. Which drug-drug interactions are known for methotrexate?
12.  which drugs interact with aciclovir (any DDI)?

#### 2. Queries related to research context application area and which could be asked by clinical researchers to identify potential confounders and risk factors for causal modeling.

1. Which drugs with AKI as side-effect are indicated for the treatment of diabetes?
2. Which drugs with AKI as side-effect are indicated for the treatment of heart failure?
3. Which drugs with AKI as side-effect are indicated for the treatment of hypertension?
4. Which drugs with AKI as side-effect are contra-indicated in patients with CKD?
5. Which drugs with AKI as side-effect are contra-indicated in heart failure?
6. Which drugs with AKI as side-effect are contra-indicated in liverinsufficiency?
7. Which drugs with AKI as side-effect have hypotension as a side-effect?
8. Which drugs with AKI as side-effect have hypo- or hyperglacemia (verhoogde/verlaagde glucosespiegel, hypo- hyperglykemie) as a side-effect?
9. Which drugs with AKI as side-effect have hypovolemia (hypovolemie, dehydratie) as a side-effect?
10. Which drugs with AKI as side-effect have sepsis as a side-effect?
11. I am studying the association between metamizol and AKI, which AKI risk factors should I consider? 
12. I am studying the association between vancomycin and AKI, which AKI risk factors should I consider?

### Future Work
We aim to continue improving the DAKI-KG, especially the following:

- **Extend the usage of disease groups to a varying set of diseases** We also aim to further investigate the quality of the MedDRA-to-SNOMED CT mappings for this use case. More groups (apart from CKD and AKI) will make it easier to query for broad diseases and retrieve all terms that are relevant, rather than querying for specific SNOMED CT branches.
- **ELT improvement** We aim to further improve the text-to-SNOMED mappings, especially for complex terms such as extensive contra-indications. For the terms that do not currently exist in SNOMED, we consider methods such as SNOMED CT Expressions, rather than relying on single terms only.

### Licensing

The DAKI-KG is made available under the [Creative Commons Attribution-NonCommercial 4.0 International - CC BY-NC](https://www.creativecommons.org/licenses/by-nc/4.0/deed.en) license. 
**Please note that** that the sources used might have their own licensing attributed:

We used the following domain knowledge sources and vocabularies:
- [Farmacotherapeutisch Kompas](https://www.farmacotherapeutischkompas.nl/)
- [G-Standaard](https://www.z-index.nl/g-standaard)
- [SNOMED CT](https://www.snomed.org/)
- [ATC](https://www.who.int/tools/atc-ddd-toolkit/atc-classification)
- [MedDRA (through BioPortal)](https://bioportal.bioontology.org/ontologies/MEDDRA)

Note that the content in de DAKI-KG does **not** represent official Farmacotherapeutisch Kompas, G-Standaard, SNOMED CT, ATC, or MedDRA content. If we break this down per source:
#### [Farmacotherapeutisch Kompas](https://www.farmacotherapeutischkompas.nl/) 
**License** Farmacotherapeutisch Kompas states that commercial use is not allowed without explicit permission from Zorginstituut Nederland. Please read [here](https://www.farmacotherapeutischkompas.nl/algemeen/copyright). 

**How we used the data** We have extracted parts of the indication, contra-indication, and side-effect sections of 786 drugs. We mapped these contents using an automated entity linking tool to SNOMED CT concepts, and created triples such as ibuprofen --hasAdverseEvent--> headache. This process simplifies the content from what is originally in FK, and potentially introduces errors. 

**Version** Our data extraction took place on 15-01-25 and 07-10-25, which might lead to discrepancies with the current version. 

#### [G-Standaard](https://www.z-index.nl/g-standaard) 
**License** Data from the G-Standaard is not publicly available. For this work, we have gotten permission from the Z-Index. 

**How we used the data** We extracted the following data: we have extracted the drug-drug interactions, their background texts, and whether they require an action from the G-Standaard. Using a keyword search on the background texts describing the drug-drug interactions and a manual review, we assigned a nephrotoxicity-label to the interactions. We do not publish the actual background text, solely the label that we assigned. This is not official G-Standaard content.

**Version** We used the version from February 2023, which might lead to descrepancies with the current version.

#### [SNOMED CT](https://www.snomed.org/) 
**License** A license is required to use SNOMED CT. 

**How we used the data** We used SNOMED CT to standardize all clinical terms in the DAKI-KG. This is partly a manual effort, but for the majority of the part an automated process with an entity linking tool. Alongside the standardized terms, we extracted the full SNOMED CT hierarchy and used this internally for querying and evaluating the KG. However, we do not publish this file: we solely use SNOMED identifiers to represent other knowledge sources. We also do not publish any SNOMED CT labels. Overall: we do not publish any structure of the SNOMED CT database.

**Version** We used the Dutch SNOMED CT version from 31-10-24. 

#### [ATC](https://www.who.int/tools/atc-ddd-toolkit/atc-classification)

**License** ATC (part of WHO) does not allow for commercial usage and does not allow for changing or manipulating the material. See [here](https://atcddd.fhi.no/copyright_disclaimer/).

**How we used the data** Data from FK and literature are represented through ATC codes. We mapped G-Standaard data to ATC through the mapping they provided.

**Version** We used the G-Standaard ATC mapping from February 2023.
#### [MedDRA](https://bioportal.bioontology.org/ontologies/MEDDRA)

**License** MedDRA requires a subscription, see [here](https://www.meddra.org/faq). 

**How we used the data** We extracted MedDRA SMQ for AKI and SMQ, and used two mappings to convert these terms to SNOMED CT terms. These mappings are many-to-one or many-to-many and hence not convertable back to the original MedDRA SMQs, nor do they reflect the original MedDRA SMQs. For AKI, we manually adjusted the terms even further. The final dataset does not contain any MedDRA terms or identifiers.

**Version** MDR27_0
